# 狼人杀 游戏逻辑

## 采用状态同步

* 状态同步即客户端将当前操作和状态发送到服务器，由服务器进行逻辑运算，再将服务器端计算得到的状态推送给客户端，由客户端进行更新。
* 服务器：存储全局状态和玩家状态，根据操作计算需要更新的状态，将需更新属性发送给玩家
* 客户端：存储自身状态，根据操作发送给服务器，并接受需要更新的属性并更新。
* 状态检查：客户端将自身状态发送给服务器，服务器检查是否一致，若不一致则将服务器端状态同步到玩家。每轮白天结束后进行（可与黑夜同步进行？）
* 防作弊：防止玩家在客户端即可读到全局信息。把数据传输都设置为单向，服务器传输给玩家的信息最少化

## 游戏逻辑

* 定12人标准版
  1. 狼人4人 村民4人 神民4人：猎人 女巫 预言家 白痴
  2. 顺序规则
     1. 第一天天黑
        1. 全员显示黑夜
        2. 狼人屏幕亮起，可被刀玩家列表出现，四人投票（可选加入少数服从多数选项），限定时间15秒，投票完毕也可结束回合。
        3. 女巫屏幕亮起，显示死亡玩家，屏幕下方出现选项：是否使用解药，选择结束后出现选择是否使用毒药，否则直接结束回合。
        4. 预言家屏幕亮起，显示可查验玩家列表，选中后出现该玩家身份（仅能验出神民或狼人两种结果）
        5. 猎人屏幕亮起，显示是否可以使用技能
        6. 白痴屏幕亮起，显示你是白痴，五秒后结束回合。
        7. 所有睁眼闭眼规则仍沿用面杀，房主设备开启音频，睁眼会播报。
     2. 第一天天亮
        1. （仅第一天黑夜过后进行）警长竞选，所有玩家屏幕上出现竞选选项以及候选人选项（即时更新），上警后可随时取消（此时不算退水），一定时间后（或全员点击确认后）上警结束
        2. 所有人屏幕显示第一夜死亡角色（此阶段猎人可亮身份并开枪，此时带走的）
        3. 第一晚死人有遗言，上帝宣布死讯后即可发言
        4. 上警发言阶段 上警玩家按顺序发言 发言完毕后点击完毕到下一个玩家发言阶段（~~此阶段~~狼人可自爆,狼人可随时自爆，之后发言终止，直接进入遗言阶段）（发言完毕后可选择退水）
        5. 所有玩家发言完毕后进入投票阶段（上警及退水玩家无投票权），非上警玩家可选择一名上警玩家投票，全员投票，定时，倒数结束后（也可进行结束投票）全员显示投票结果，警长屏幕出现警徽。
        6. 警长选择放逐投票发言顺序：警左警右或死左死右（一人死亡则死左死右或警左警右，两人或无人则警左警右）
        7. 全员发言完毕后进行放逐投票（警长票为1.5票），定时投票，投票完毕后再宣布结果。
        8. 若有平票，则进入pk环节，随机一人先发言，二人发言完毕后全员（活人）投票，投票同上。
        9. 若还有，重复pk，知道系统决出一人被放逐。（若是猎人则亮身份并开枪）
        10. 进入黑夜 全员屏幕显示黑夜
     3. 第二天及以后黑夜
        1. 规则和顺序同第一天黑夜
     4. 第二天及以后白天
        1. 上帝宣布死亡玩家，由于夜晚死亡所以无遗言。猎人除了被毒杀都可以开枪带走，带走的人算作与猎人同一时间死亡。
        2. 警长选择发言顺序（规则见3.6）
        3. 轮流发言，完毕后警长归票（包含在警长发言内，可以不参与客户端响应）
        4. 所有人投票放逐
        5. 放逐者发表遗言
  3. 全局规则（可能在任何时候生效或可能在流程中调用多次的规则）
     1. 猎人死时可以带走一个，被毒死不行，带走的那个算作与猎人同一时间死亡
     2. 狼人可以在任何时候自爆，自爆后自己有遗言，然后全员进入黑夜
     3. 白天死的人有遗言，晚上没有，第一晚例外
     4.

## 运行逻辑（页面切换显示）

1.

## 细节化为代码逻辑（数据结构前后端行为通信）

1. 游戏逻辑部分
2. 数据结构部分
   1. 全局状态：
      1. 需要表示的量：
         1.
   2. 玩家状态：
   3. 传输数据包：
      1. 操作数据
      2. 同步数据

## 技术栈细节（边做边加！）

## Coding!
